# AetherCore Bunker Mode Prometheus Configuration
# 72-hour retention optimized for tactical SSDs
# Scrapes all mission-critical services

global:
  scrape_interval: 15s
  scrape_timeout: 10s
  evaluation_interval: 15s
  external_labels:
    cluster: 'bunker'
    environment: 'tactical'

# Alertmanager configuration (optional)
# alerting:
#   alertmanagers:
#     - static_configs:
#         - targets: ['alertmanager:9093']

# Rule files (optional)
# rule_files:
#   - '/etc/prometheus/rules/*.yml'

scrape_configs:
  # Prometheus self-monitoring
  - job_name: 'prometheus'
    static_configs:
      - targets: ['localhost:9090']
        labels:
          service: 'prometheus'

  # PostgreSQL exporter (if deployed)
  - job_name: 'postgres'
    static_configs:
      - targets: ['postgres:5432']
        labels:
          service: 'postgres'
          layer: 'state'

  # Redis exporter (if deployed)
  - job_name: 'redis'
    static_configs:
      - targets: ['redis:6379']
        labels:
          service: 'redis'
          layer: 'state'

  # MinIO metrics
  - job_name: 'minio'
    metrics_path: /minio/v2/metrics/cluster
    static_configs:
      - targets: ['minio:9000']
        labels:
          service: 'minio'
          layer: 'truth'

  # Gateway service
  - job_name: 'gateway'
    static_configs:
      - targets: ['gateway:3000']
        labels:
          service: 'gateway'
          layer: 'engine'

  # Auth service
  - job_name: 'auth'
    static_configs:
      - targets: ['auth:3001']
        labels:
          service: 'auth'
          layer: 'engine'

  # Collaboration service
  - job_name: 'collaboration'
    static_configs:
      - targets: ['collaboration:8080']
        labels:
          service: 'collaboration'
          layer: 'engine'

  # Fleet service
  - job_name: 'fleet'
    static_configs:
      - targets: ['fleet:3002']
        labels:
          service: 'fleet'
          layer: 'engine'

  # H2-Ingest service (host network)
  - job_name: 'h2-ingest'
    static_configs:
      - targets: ['localhost:8090']
        labels:
          service: 'h2-ingest'
          layer: 'engine'
          language: 'rust'

  # Nginx exporter (if deployed)
  - job_name: 'nginx'
    static_configs:
      - targets: ['nginx:80']
        labels:
          service: 'nginx'
          layer: 'glass'
